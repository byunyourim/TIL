메모리는 크게 커널과 유저 영역으로 나뉜다.  

커널 영역에는 운영체제의 커널이 적재되고, 유저 영역에는 일반 프로세스가 적재된다.  

프로그램이 실행되기 위해서는 프로그램이 주 메모리에 로드되어 실행되어야 한다.  
또한, 프로그램 중 사용할 변수와 데이터들을 메모리에 저장하여 사용한다.  

유저 영역에 적재되는 프로세스의 메모리 구조를 보자.

<img width="322" alt="스크린샷 2024-10-24 오전 11 21 26" src="https://github.com/user-attachments/assets/4028a7c0-2d00-4b4f-9d13-73e066e73949">

<br>

크게 코드, 데이터, 힙, 스택 영역으로 나뉜다.
<br>


### 코드 영역
실행할 프로그램의 코드가 저장된 영역으로 텍스트 영역이라고도 부른다.  
명령문이 저장되는 곳으로, 제어문, 함수, 상수들이 이곳에 저장된다.  

CPU는 코드 영역에 저장된 명령어를 하나씩 가져가서 처리한다.  


<br>

### 데이터 영역
프로그램이 종료될 때까지 지워지지 않는 데이터를 저장한다.  
대표적으로 전역변수와 스태틱 변수, 상수가 있다.  
프로그램ㅁ의 시작과 함께 할당되고, 종료될 때까지 메모리 상에 존재한다.


<br>

### 스택 영역 (자동 메모리)
함수 호출과 관계되는 지역변수와 매개변수가 저장된다. 
컴파일 타임에 크기가 할당되며, 함수의 호출과 함께 할당되고, 종료시 소멸한다.
높은 주소에서 낮은 주소 방향으로 할당된다.  

잠깐 사용하고 삭제하는 데이터를 저장한다, 지역변수와 매개변수가 있으며
해당 객체가 정의된 블록을 벗어날 때 소멸된다.  
함수의 호출 위치도 저장하며, 힙보다 빠르다.

> #### 스택 오버플로우
> 프로그램이 사용하는 스택 메모리가 할당된 최대 크기를 초과할 때 발생한다.
> - 무한 재귀 호출
> - 너무 많은 지역 변수
> - 너무 깊은 호출 스택

<br>

### 힙 영역 (자유 저장소)
스택보다 큰 메모리를 할당 받기 위해 사용되며, 동적으로 메모리를 할당한다.  
스택보다 느리다.  
런타임에 크기가 결정된다.  

커널 영역을 보호하기 위해 메모리의 낮은 주소에서 높은주소로 할당된다.

> #### 힙 오버플로우
> 런타임 동안 객체를 너무 많이 생성하여 힙 메모리가 가득 찰 때 발생한다.
> - 과도한 객체 생성
> - 메모리 누수
> - 무한 루프, 재귀로 인해 객체를 계속해서 생성하는 경우


<br><br><br>


## 커널 영역의 메모리 구조
### 코드 
시스템 콜/인터럽트 처리 코드, 자원 관리를 위한 코드, 편리한 인터페이스 제공을 위한 코드

<br>

### 데이터
모든 하드웨어 (CPU, 메모리)를 관리하기 위한 자료구조, 
모든 프로세스들을 관리하기 위한 자료구조


<br>


### 스택 (프로세스 커널 스택)
각 프로세스마다 별도로 둔다.
